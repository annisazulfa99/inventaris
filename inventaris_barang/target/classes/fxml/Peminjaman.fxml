<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<!--
================================================================
File: src/main/resources/fxml/Peminjaman.fxml
Peminjaman & Pengembalian Screen
================================================================
-->

<ScrollPane 
    fx:id="rootPane"
    xmlns="http://javafx.com/javafx"
    xmlns:fx="http://javafx.com/fxml/1"
    fx:controller="com.inventaris.controller.PeminjamanController"
    fitToWidth="true" pannable="true" hbarPolicy="AS_NEEDED">

<VBox spacing="20" style="-fx-padding: 30; -fx-background-color: #f7fafc;">
    
    <HBox spacing="30" alignment="CENTER_LEFT">
                <Label fx:id="lblSimak" text="SIMAK"
                       onMouseClicked="#handleDashboard"
                       style="-fx-font-size: 48px; -fx-font-weight: bold; -fx-text-fill: #6A5436; -fx-cursor: hand;"/>

                <TextField fx:id="txtSearch" promptText="pencarian"
                           prefHeight="40" prefWidth="800"
                           style="-fx-background-color: #D9CBC1; -fx-background-radius: 10; -fx-font-size: 16px; -fx-padding: 10;" />
                <Button text="ðŸ” Cari" onAction="#handleSearch"
                        style="-fx-background-color: #8C6E63; -fx-text-fill: white; -fx-background-radius: 10;" />
            </HBox>
        <!-- NAVIGATION -->
            <HBox spacing="20" alignment="CENTER_LEFT">
                <Button fx:id="btnDashboard" text="Dashboard"
                        onAction="#handleHome"
                        style="-fx-background-color: #D9CBC1; -fx-background-radius: 25;
                               -fx-font-weight: bold; -fx-font-size: 16px; -fx-cursor: hand;"
                        prefWidth="180" prefHeight="50"/>

                <Button fx:id="btnPeminjaman" text="Peminjaman"
                        onAction="#handlePeminjaman"
                        style="-fx-background-color: #D9CBC1; -fx-background-radius: 25;
                               -fx-font-weight: bold; -fx-font-size: 16px; -fx-cursor: hand;"
                        prefWidth="180" prefHeight="50"/>

                <Button fx:id="btnLaporan" text="Laporan"
                        onAction="#handleLaporan"
                        style="-fx-background-color: #D9CBC1; -fx-background-radius: 25;
                               -fx-font-weight: bold; -fx-font-size: 16px; -fx-cursor: hand;"
                        prefWidth="180" prefHeight="50"/>

                <Button fx:id="btnBarang" text="Data Barang"
                        onAction="#handleBarang"
                        style="-fx-background-color: #D9CBC1; -fx-background-radius: 25;
                               -fx-font-weight: bold; -fx-font-size: 16px; -fx-cursor: hand;"
                        prefWidth="180" prefHeight="50"/>
                
            </HBox>
    <!-- Header -->
    <HBox alignment="CENTER_LEFT" spacing="20">
        <Label text="Peminjaman Barang" styleClass="header-title">
            <font><Font name="System Bold" size="24.0" /></font>
        </Label>
        
        <Region HBox.hgrow="ALWAYS" />
        
        <Button text="ðŸ”„ Refresh" onAction="#handleRefresh" styleClass="btn-secondary" />
    </HBox>
    
    <Separator />
    
    <!-- Tab Pane -->
    <TabPane fx:id="tabPane" VBox.vgrow="ALWAYS" tabClosingPolicy="UNAVAILABLE">
        
        <!-- TAB 1: Form Pengajuan Peminjaman -->
        <Tab fx:id="tabPengajuan" text="ðŸ“ Ajukan Peminjaman">
            <VBox spacing="20" style="-fx-padding: 20;">
                
                <!-- Form Card -->
                <VBox spacing="15" styleClass="card" style="-fx-padding: 25; -fx-max-width: 600;">
                    <Label text="Form Peminjaman Baru" styleClass="card-title">
                        <font><Font name="System Bold" size="18.0" /></font>
                    </Label>
                    
                    <Separator />
                    
                    <!-- Pilih Barang -->
                    <VBox spacing="5">
                        <Label text="Pilih Barang *" styleClass="field-label" />
                        <ComboBox fx:id="barangCombo" maxWidth="Infinity" prefHeight="35" />
                        <Label fx:id="stokTersediaLabel" text="Pilih barang terlebih dahulu" 
                               style="-fx-text-fill: #718096; -fx-font-size: 12px;" />
                    </VBox>
                    
                    <!-- Jumlah Pinjam -->
                    <VBox spacing="5">
                        <Label text="Jumlah Pinjam *" styleClass="field-label" />
                        <TextField fx:id="jumlahPinjamField" promptText="Masukkan jumlah" />
                    </VBox>
                    
                    <!-- Tanggal Pinjam & Deadline -->
                    <HBox spacing="15">
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="Tanggal Pinjam *" styleClass="field-label" />
                            <DatePicker fx:id="tglPinjamPicker" maxWidth="Infinity" />
                        </VBox>
                        
                        <VBox spacing="5" HBox.hgrow="ALWAYS">
                            <Label text="Deadline Kembali *" styleClass="field-label" />
                            <DatePicker fx:id="dlKembaliPicker" maxWidth="Infinity" />
                        </VBox>
                    </HBox>
                    
                    <Separator />
                    
                    <!-- Submit Button -->
                    <Button fx:id="btnPinjam" text="ðŸ“¤ Ajukan Peminjaman" onAction="#handlePinjam" 
                           styleClass="btn-primary" prefHeight="45" maxWidth="Infinity">
                        <font><Font name="System Bold" size="14.0" /></font>
                    </Button>
                    
                    <Label text="* Wajib diisi | Pengajuan akan diproses oleh admin" 
                           style="-fx-text-fill: #718096; -fx-font-size: 12px; -fx-font-style: italic;" />
                </VBox>
                
                <!-- Info Card -->
                <VBox spacing="10" styleClass="card" style="-fx-padding: 20; -fx-max-width: 600; -fx-background-color: #ebf8ff;">
                    <Label text="â„¹ï¸ Informasi Peminjaman" style="-fx-font-weight: bold; -fx-text-fill: #2c5282;" />
                    <Label text="â€¢ Pengajuan peminjaman akan diproses oleh admin" wrapText="true" 
                           style="-fx-text-fill: #2d3748;" />
                    <Label text="â€¢ Pastikan mengembalikan barang sebelum deadline" wrapText="true" 
                           style="-fx-text-fill: #2d3748;" />
                    <Label text="â€¢ Keterlambatan akan dicatat dalam sistem" wrapText="true" 
                           style="-fx-text-fill: #2d3748;" />
                </VBox>
                
            </VBox>
        </Tab>
        
        <!-- TAB 2: Peminjaman Aktif -->
        <Tab fx:id="tabAktif" text="ðŸ“¦ Peminjaman Aktif">
            <VBox spacing="15" style="-fx-padding: 20;">
                
                <HBox alignment="CENTER_LEFT">
                    <Label text="Daftar Barang yang Sedang Dipinjam" styleClass="card-title">
                        <font><Font name="System Bold" size="18.0" /></font>
                    </Label>
                </HBox>
                
                <TableView fx:id="activeTable" styleClass="card" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colActiveId" text="ID" prefWidth="50" />
                        <TableColumn fx:id="colActivePeminjam" text="Peminjam" prefWidth="150" />
                        <TableColumn fx:id="colActiveBarang" text="Barang" prefWidth="180" />
                        <TableColumn fx:id="colActiveJumlah" text="Jumlah" prefWidth="70" />
                        <TableColumn fx:id="colActiveTglPinjam" text="Tgl Pinjam" prefWidth="100" />
                        <TableColumn fx:id="colActiveDeadline" text="Deadline" prefWidth="100" />
                        <TableColumn fx:id="colActiveSisaHari" text="Sisa Waktu" prefWidth="100" />
                        <TableColumn fx:id="colActiveAction" text="Aksi" prefWidth="120" />
                    </columns>
                    <placeholder>
                        <Label text="Belum ada peminjaman aktif" style="-fx-text-fill: #a0aec0;" />
                    </placeholder>
                </TableView>
                
            </VBox>
        </Tab>
        
        <!-- TAB 3: Pending Approval (Admin Only) -->
        <Tab fx:id="tabPending" text="â³ Menunggu Persetujuan">
            <VBox spacing="15" style="-fx-padding: 20;">
                
                <HBox alignment="CENTER_LEFT">
                    <Label text="Pengajuan Peminjaman (Menunggu Approval)" styleClass="card-title">
                        <font><Font name="System Bold" size="18.0" /></font>
                    </Label>
                </HBox>
                
                <TableView fx:id="pendingTable" styleClass="card" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colPendingId" text="ID" prefWidth="50" />
                        <TableColumn fx:id="colPendingPeminjam" text="Peminjam" prefWidth="180" />
                        <TableColumn fx:id="colPendingBarang" text="Barang" prefWidth="200" />
                        <TableColumn fx:id="colPendingJumlah" text="Jumlah" prefWidth="80" />
                        <TableColumn fx:id="colPendingTgl" text="Tgl Pengajuan" prefWidth="120" />
                        <TableColumn fx:id="colPendingAction" text="Aksi" prefWidth="200" />
                    </columns>
                    <placeholder>
                        <Label text="Tidak ada pengajuan pending" style="-fx-text-fill: #a0aec0;" />
                    </placeholder>
                </TableView>
                
            </VBox>
        </Tab>
        
        <!-- TAB 4: Riwayat -->
        <Tab fx:id="tabRiwayat" text="ðŸ“Š Riwayat Peminjaman">
            <VBox spacing="15" style="-fx-padding: 20;">
                
                <HBox alignment="CENTER_LEFT">
                    <Label text="Riwayat Peminjaman (Selesai)" styleClass="card-title">
                        <font><Font name="System Bold" size="18.0" /></font>
                    </Label>
                </HBox>
                
                <TableView fx:id="historyTable" styleClass="card" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colHistoryId" text="ID" prefWidth="50" />
                        <TableColumn fx:id="colHistoryPeminjam" text="Peminjam" prefWidth="150" />
                        <TableColumn fx:id="colHistoryBarang" text="Barang" prefWidth="200" />
                        <TableColumn fx:id="colHistoryTglPinjam" text="Tgl Pinjam" prefWidth="100" />
                        <TableColumn fx:id="colHistoryTglKembali" text="Tgl Kembali" prefWidth="100" />
                        <TableColumn fx:id="colHistoryStatus" text="Status" prefWidth="120" />
                    </columns>
                    <placeholder>
                        <Label text="Belum ada riwayat" style="-fx-text-fill: #a0aec0;" />
                    </placeholder>
                </TableView>
                
            </VBox>
        </Tab>
        
    </TabPane>
    
</VBox>
</ScrollPane>